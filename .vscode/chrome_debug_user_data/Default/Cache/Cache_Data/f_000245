
        <!DOCTYPE html>
        <html lang="en">
          <head>
            <meta charset="UTF-8" />
            <title>Error</title>
            <script type="module">
              const error = {"message":"Attribute name cannot contain U+0022 (\"), U+0027 ('), and U+003C (\u003c).","stack":"    at createCompilerError (C:\\respos\\AlmaPhone\\node_modules\\.pnpm\\@vue+compiler-core@3.5.17\\node_modules\\@vue\\compiler-core\\dist\\compiler-core.cjs.js:1364:17)\n    at Object.emitError [as onerr] (C:\\respos\\AlmaPhone\\node_modules\\.pnpm\\@vue+compiler-core@3.5.17\\node_modules\\@vue\\compiler-core\\dist\\compiler-core.cjs.js:2949:5)\n    at Tokenizer.stateInAttrName (C:\\respos\\AlmaPhone\\node_modules\\.pnpm\\@vue+compiler-core@3.5.17\\node_modules\\@vue\\compiler-core\\dist\\compiler-core.cjs.js:854:16)\n    at Tokenizer.parse (C:\\respos\\AlmaPhone\\node_modules\\.pnpm\\@vue+compiler-core@3.5.17\\node_modules\\@vue\\compiler-core\\dist\\compiler-core.cjs.js:1103:16)\n    at Object.baseParse (C:\\respos\\AlmaPhone\\node_modules\\.pnpm\\@vue+compiler-core@3.5.17\\node_modules\\@vue\\compiler-core\\dist\\compiler-core.cjs.js:2988:13)\n    at Object.parse (C:\\respos\\AlmaPhone\\node_modules\\.pnpm\\@vue+compiler-dom@3.5.17\\node_modules\\@vue\\compiler-dom\\dist\\compiler-dom.cjs.js:907:23)\n    at Object.parse$1 [as parse] (C:\\respos\\AlmaPhone\\node_modules\\.pnpm\\@vue+compiler-sfc@3.5.17\\node_modules\\@vue\\compiler-sfc\\dist\\compiler-sfc.cjs.js:1794:24)\n    at createDescriptor (file:///C:/respos/AlmaPhone/node_modules/.pnpm/@vitejs+plugin-vue@5.2.4_vi_67cee780d49b789806fcc08f436aad97/node_modules/@vitejs/plugin-vue/dist/index.mjs:71:43)\n    at handleHotUpdate (file:///C:/respos/AlmaPhone/node_modules/.pnpm/@vitejs+plugin-vue@5.2.4_vi_67cee780d49b789806fcc08f436aad97/node_modules/@vitejs/plugin-vue/dist/index.mjs:2198:26)\n    at async handleHMRUpdate (file:///C:/respos/AlmaPhone/node_modules/.pnpm/vite@6.3.5_@types+node@22.1_7f6bc045e337fea346aeaedaeeb5c238/node_modules/vite/dist/node/chunks/dep-DBxKXgDP.js:39213:33)","id":"C:/respos/AlmaPhone/src/views/PhoneView.vue","frame":"160|  \n161|          \u003c!-- Audio/Mic -->\n162|          \u003cbutton @click=\"toggleDialOptions\"  hover:bg-blue-600'\"\n   |                                                                ^\n163|            v-tooltip.top=\"'Configuración de audio y micrófono'\"\n164|            class=\"control-button text-white font-medium py-4 px-3 rounded-lg transition-colors flex flex-col items-center space-y-1\">","plugin":"vite:vue","pluginCode":"\u003ctemplate>\n  \u003cdiv class=\"softphone-container flex gap-4 p-4 bg-gray-100 dark:bg-gray-900 min-h-screen\">\n    \u003c!-- Panel principal del teléfono - ancho fijo 320px -->\n    \u003cdiv class=\"phone-dialer bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6 border border-gray-200 dark:border-gray-700 w-[320px] flex-shrink-0\">\n      \u003c!-- Header con información de la extensión -->\n      \u003cdiv class=\"mb-6\">\n        \u003cdiv class=\"flex items-center justify-between mb-4\">\n          \u003ch3 class=\"text-lg font-semibold text-gray-900 dark:text-white\">\n            {{ extensionStore.selectedExtension?.extension }} ({{ extensionStore.selectedExtension?.effective_caller_id_name ?? 'Cyrus Kelly' }})\n          \u003c/h3>\n          \u003cdiv class=\"flex items-center space-x-2\">\n            \u003cdiv :class=\"connectionStatusClass\" class=\"w-3 h-3 rounded-full\">\u003c/div>\n            \u003cspan class=\"text-sm font-medium\" :class=\"connectionStatusTextClass\">\n              {{ connectionStatus }}\n            \u003c/span>\n          \u003c/div>\n        \u003c/div>\n      \u003c/div>\n\n      \u003c!-- Display del número -->\n      \u003cdiv class=\"mb-6\">\n        \u003cdiv class=\"bg-gray-50 dark:bg-gray-700 rounded-lg p-4 border-2 border-gray-200 dark:border-gray-600\">\n          \u003cinput v-model=\"displayNumber\" type=\"text\" readonly placeholder=\"Ingrese un número\"\n            class=\"w-full text-center text-2xl font-mono bg-transparent border-none focus:outline-none text-gray-900 dark:text-white placeholder-gray-400\" />\n        \u003c/div>\n      \u003c/div>\n\n      \u003c!-- Teclado numérico -->\n      \u003cdiv class=\"mb-6\">\n        \u003cdiv class=\"grid grid-cols-3 gap-3\">\n          \u003cbutton v-for=\"key in dialpadKeys\" :key=\"key.value\" @click=\"addDigit(key.value)\" :disabled=\"isCallActive\"\n            class=\"dial-button relative flex flex-col items-center justify-center h-16 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed focus:outline-none focus:ring-2 focus:ring-blue-500\">\n            \u003cspan class=\"text-2xl font-bold text-gray-900 dark:text-white\">{{ key.value }}\u003c/span>\n            \u003cspan v-if=\"key.letters\" class=\"text-xs text-gray-500 dark:text-gray-400 mt-1\">\n              {{ key.letters }}\n            \u003c/span>\n          \u003c/button>\n        \u003c/div>\n      \u003c/div>\n\n      \u003c!-- Botones de acción principales -->\n      \u003cdiv class=\"flex justify-center space-x-4 mb-6\">\n        \u003c!-- Botón de llamada -->\n        \u003cbutton @click=\"handleCall\" :disabled=\"!canCall\" :class=\"callButtonClass\"\n          class=\"flex items-center justify-center w-16 h-16 rounded-full transition-all duration-200 focus:outline-none focus:ring-4 focus:ring-opacity-50 disabled:opacity-50 disabled:cursor-not-allowed\">\n          \u003csvg v-if=\"!isCallActive\" class=\"w-8 h-8 text-white\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n            \u003cpath stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\"\n              d=\"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z\" />\n          \u003c/svg>\n          \u003csvg v-else class=\"w-8 h-8 text-white\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n            \u003cpath stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\"\n              d=\"M16 8l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2M3 3l18 18\" />\n          \u003c/svg>\n        \u003c/button>\n\n        \u003c!-- Botón de borrar unificado -->\n        \u003cbutton \n          @mousedown=\"startDelete\"\n          @mouseup=\"endDelete\"\n          @mouseleave=\"endDelete\"\n          @touchstart=\"startDelete\"\n          @touchend=\"endDelete\"\n          @touchcancel=\"endDelete\"\n          :disabled=\"displayNumber.length === 0 || isCallActive\"\n          :class=\"isDeleting ? 'bg-red-500 hover:bg-red-600 focus:ring-red-500' : 'bg-gray-500 hover:bg-gray-600 focus:ring-gray-500'\"\n          class=\"flex items-center justify-center w-16 h-16 rounded-full transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed focus:outline-none focus:ring-4 focus:ring-opacity-50\">\n          \u003csvg class=\"w-6 h-6 text-white\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n            \u003cpath stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\"\n              d=\"M12 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2M3 12l6.414 6.414a2 2 0 001.414.586H19a2 2 0 002-2V7a2 2 0 00-2-2h-8.172a2 2 0 00-1.414.586L3 12z\" />\n          \u003c/svg>\n        \u003c/button>\n      \u003c/div>\n\n      \u003c!-- Estado de la llamada -->\n      \u003cdiv v-if=\"isCallActive\" class=\"mb-4\">\n        \u003cdiv class=\"bg-blue-50 dark:bg-blue-900 rounded-lg p-4 border border-blue-200 dark:border-blue-700\">\n          \u003cdiv class=\"flex items-center justify-between\">\n            \u003cdiv class=\"flex items-center space-x-3\">\n              \u003cdiv class=\"w-3 h-3 bg-blue-500 rounded-full animate-pulse\">\u003c/div>\n              \u003cspan class=\"text-sm font-medium text-blue-900 dark:text-blue-100\">\n                Llamando a {{ currentCallNumber }}\n              \u003c/span>\n            \u003c/div>\n            \u003cspan class=\"text-sm text-blue-700 dark:text-blue-300\">\n              {{ callDuration }}\n            \u003c/span>\n          \u003c/div>\n        \u003c/div>\n      \u003c/div>\n\n      \u003c!-- Historial de llamadas recientes -->\n      \u003cdiv class=\"mt-6\">\n        \u003ch4 class=\"text-sm font-medium text-gray-900 dark:text-white mb-3\">\n          Llamadas Recientes\n        \u003c/h4>\n        \u003cdiv class=\"space-y-2 max-h-40 overflow-y-auto\">\n          \u003cdiv v-for=\"call in recentCalls\" :key=\"call.id\" @click=\"selectRecentCall(call.number)\"\n            class=\"flex items-center justify-between p-3 bg-gray-50 dark:bg-gray-700 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-600 cursor-pointer transition-colors\">\n            \u003cdiv class=\"flex items-center space-x-3\">\n              \u003csvg :class=\"call.type === 'outgoing' ? 'text-green-500' : 'text-blue-500'\" class=\"w-4 h-4\" fill=\"none\"\n                stroke=\"currentColor\" viewBox=\"0 0 24 24\">\n                \u003cpath stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\"\n                  d=\"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z\" />\n              \u003c/svg>\n              \u003cspan class=\"text-sm font-medium text-gray-900 dark:text-white\">\n                {{ call.number }}\n              \u003c/span>\n            \u003c/div>\n            \u003cspan class=\"text-xs text-gray-500 dark:text-gray-400\">\n              {{ formatTime(call.timestamp) }}\n            \u003c/span>\n          \u003c/div>\n        \u003c/div>\n      \u003c/div>\n    \u003c/div>\n\n    \u003c!-- Panel de controles - 50% del espacio restante -->\n    \u003cdiv class=\"control-panel bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6 border border-gray-200 dark:border-gray-700 flex-1 min-w-0\">\n      \u003ch3 class=\"text-lg font-semibold text-gray-900 dark:text-white mb-6\">Controles\u003c/h3>\n      \n      \u003c!-- Estado de registro -->\n      \u003cdiv class=\"mb-6\">\n        \u003cdiv class=\"bg-red-50 dark:bg-red-900 rounded-lg p-4 border border-red-200 dark:border-red-700\">\n          \u003cdiv class=\"flex items-center justify-between\">\n            \u003cdiv class=\"flex items-center space-x-3\">\n              \u003cdiv class=\"w-3 h-3 bg-red-500 rounded-full\">\u003c/div>\n              \u003cspan class=\"text-sm font-medium text-red-900 dark:text-red-100\">\n                Sara: Unregistered\n              \u003c/span>\n            \u003c/div>\n          \u003c/div>\n        \u003c/div>\n      \u003c/div>\n\n      \u003c!-- Botones principales en grilla -->\n      \u003cdiv class=\"grid grid-cols-2 gap-3 mb-6\">\n        \u003c!-- Redial -->\n        \u003cbutton @click=\"redial\" :disabled=\"!lastDialedNumber\" \n          v-tooltip.top=\"'Repetir última llamada'\"\n          class=\"control-button bg-green-500 hover:bg-green-600 disabled:bg-gray-400 text-white font-medium py-4 px-3 rounded-lg transition-colors disabled:cursor-not-allowed flex flex-col items-center space-y-1\">\n          \u003cRotateCcw :size=\"20\" />\n          \u003cspan class=\"text-xs\">ReDial\u003c/span>\n        \u003c/button>\n        \n        \u003c!-- DND -->\n        \u003cbutton @click=\"toggleDnd\" :class=\"isDnd ? 'bg-orange-600' : 'bg-orange-500 hover:bg-orange-600'\"\n          v-tooltip.top=\"'No molestar'\"\n          class=\"control-button text-white font-medium py-4 px-3 rounded-lg transition-colors flex flex-col items-center space-y-1\">\n          \u003cBellOff :size=\"20\" />\n          \u003cspan class=\"text-xs\">{{ isDnd ? 'DND ON' : 'DND' }}\u003c/span>\n        \u003c/button>\n\n        \u003c!-- Voicemail -->\n        \u003cbutton @click=\"checkVoicemail\" \n          v-tooltip.top=\"'Revisar mensajes de voz'\"\n          class=\"control-button bg-teal-500 hover:bg-teal-600 text-white font-medium py-4 px-3 rounded-lg transition-colors flex flex-col items-center space-y-1\">\n          \u003cVoicemail :size=\"20\" />\n          \u003cspan class=\"text-xs\">VoiceMail: {{ phoneStore.voicemail.new }}/{{ phoneStore.voicemail.old }}\u003c/span>\n        \u003c/button>\n\n        \u003c!-- Audio/Mic -->\n        \u003cbutton @click=\"toggleDialOptions\"  hover:bg-blue-600'\"\n          v-tooltip.top=\"'Configuración de audio y micrófono'\"\n          class=\"control-button text-white font-medium py-4 px-3 rounded-lg transition-colors flex flex-col items-center space-y-1\">\n          \u003ccomponent :is=\"isAudioMicActive ? 'Mic' : 'MicOff'\" :size=\"20\" />\n          \u003cspan class=\"text-xs\">{{ isAudioMicActive ? 'Audio ON' : 'Audio/Mic' }}\u003c/span>\n        \u003c/button>\n      \u003c/div>\n\n      \u003c!-- Controles de llamada en curso -->\n      \u003cdiv v-if=\"isCallActive\" class=\"grid grid-cols-2 gap-3 mb-6\">\n        \u003cbutton @click=\"toggleMute\" :class=\"isMuted ? 'bg-red-600' : 'bg-orange-500 hover:bg-orange-600'\"\n          v-tooltip.top=\"isMuted ? 'Activar timbre' : 'Silenciar timbre'\"\n          class=\"control-button text-white font-medium py-4 px-3 rounded-lg transition-colors flex flex-col items-center space-y-1\">\n          \u003ccomponent :is=\"isMuted ? 'VolumeX' : 'Volume2'\" :size=\"20\" />\n          \u003cspan class=\"text-xs\">{{ isMuted ? 'UNMUTE' : 'MUTE' }}\u003c/span>\n        \u003c/button>\n        \n        \u003cbutton @click=\"toggleAutoAnswer\" :class=\"isAutoAnswerActive ? 'bg-orange-600' : 'bg-orange-500 hover:bg-orange-600'\"\n          v-tooltip.top=\"'Respuesta automática'\"\n          class=\"control-button text-white font-medium py-4 px-3 rounded-lg transition-colors flex flex-col items-center space-y-1\">\n          \u003ccomponent :is=\"isAutoAnswerActive ? 'PhoneCall' : 'PhoneIncoming'\" :size=\"20\" />\n          \u003cspan class=\"text-xs\">{{ isAutoAnswerActive ? 'AUTO ON' : 'AUTO ANS' }}\u003c/span>\n        \u003c/button>\n      \u003c/div>\n\n      \u003c!-- Acciones adicionales -->\n      \u003cdiv class=\"grid grid-cols-1 gap-3\">\n        \u003c!-- Transfer -->\n        \u003cbutton @click=\"transferCall\" :disabled=\"!isCallActive\"\n          v-tooltip.top=\"'Transferir llamada'\"\n          class=\"control-button bg-purple-500 hover:bg-purple-600 disabled:bg-gray-400 text-white font-medium py-4 px-3 rounded-lg transition-colors disabled:cursor-not-allowed flex items-center justify-center space-x-2\">\n          \u003cArrowRightLeft :size=\"20\" />\n          \u003cspan class=\"text-sm\">Transfer\u003c/span>\n        \u003c/button>\n\n        \u003c!-- Hold -->\n        \u003cbutton @click=\"toggleHold\" :disabled=\"!isCallActive\" \n          :class=\"isOnHold ? 'bg-yellow-600' : 'bg-yellow-500 hover:bg-yellow-600'\"\n          v-tooltip.top=\"isOnHold ? 'Quitar de espera' : 'Poner en espera'\"\n          class=\"control-button disabled:bg-gray-400 text-white font-medium py-4 px-3 rounded-lg transition-colors disabled:cursor-not-allowed flex items-center justify-center space-x-2\">\n          \u003ccomponent :is=\"isOnHold ? 'Play' : 'Pause'\" :size=\"20\" />\n          \u003cspan class=\"text-sm\">{{ isOnHold ? 'UNHOLD' : 'HOLD' }}\u003c/span>\n        \u003c/button>\n      \u003c/div>\n    \u003c/div>\n\n    \u003c!-- Panel dinámico - 50% del espacio restante -->\n    \u003cdiv class=\"dynamic-panel bg-white dark:bg-gray-800 rounded-lg shadow-sm p-6 border border-gray-200 dark:border-gray-700 flex-1 min-w-0\">\n      \u003ch3 class=\"text-lg font-semibold text-gray-900 dark:text-white mb-6\">Información\u003c/h3>\n      \n      \u003c!-- Estado de conexión detallado -->\n      \u003cdiv class=\"mb-6\">\n        \u003ch4 class=\"text-sm font-medium text-gray-900 dark:text-white mb-3\">Estado de Conexión\u003c/h4>\n        \u003cdiv class=\"bg-gray-50 dark:bg-gray-700 rounded-lg p-4\">\n          \u003cdiv class=\"space-y-2\">\n            \u003cdiv class=\"flex justify-between\">\n              \u003cspan class=\"text-sm text-gray-600 dark:text-gray-400\">SIP:\u003c/span>\n              \u003cspan :class=\"connectionStatusTextClass\" class=\"text-sm font-medium\">\n                {{ connectionStatus }}\n              \u003c/span>\n            \u003c/div>\n            \u003cdiv class=\"flex justify-between\">\n              \u003cspan class=\"text-sm text-gray-600 dark:text-gray-400\">Estado:\u003c/span>\n              \u003cspan class=\"text-sm font-medium text-gray-900 dark:text-white\">\n                {{ phoneStore.connectionState }}\n              \u003c/span>\n            \u003c/div>\n            \u003cdiv class=\"flex justify-between\">\n              \u003cspan class=\"text-sm text-gray-600 dark:text-gray-400\">Llamada:\u003c/span>\n              \u003cspan class=\"text-sm font-medium text-gray-900 dark:text-white\">\n                {{ phoneStore.callState }}\n              \u003c/span>\n            \u003c/div>\n          \u003c/div>\n        \u003c/div>\n      \u003c/div>\n\n      \u003c!-- Configuración SIP -->\n      \u003cdiv class=\"mb-6\">\n        \u003ch4 class=\"text-sm font-medium text-gray-900 dark:text-white mb-3\">Configuración SIP\u003c/h4>\n        \u003cdiv class=\"bg-gray-50 dark:bg-gray-700 rounded-lg p-4\">\n          \u003cdiv class=\"space-y-2\">\n            \u003cdiv class=\"flex justify-between\">\n              \u003cspan class=\"text-sm text-gray-600 dark:text-gray-400\">Servidor:\u003c/span>\n              \u003cspan class=\"text-sm font-medium text-gray-900 dark:text-white\">\n                {{ phoneStore.sipConfig.server }}\n              \u003c/span>\n            \u003c/div>\n            \u003cdiv class=\"flex justify-between\">\n              \u003cspan class=\"text-sm text-gray-600 dark:text-gray-400\">Usuario:\u003c/span>\n              \u003cspan class=\"text-sm font-medium text-gray-900 dark:text-white\">\n                {{ phoneStore.sipConfig.username }}\n              \u003c/span>\n            \u003c/div>\n            \u003cdiv class=\"flex justify-between\">\n              \u003cspan class=\"text-sm text-gray-600 dark:text-gray-400\">Dominio:\u003c/span>\n              \u003cspan class=\"text-sm font-medium text-gray-900 dark:text-white\">\n                {{ phoneStore.sipConfig.domain }}\n              \u003c/span>\n            \u003c/div>\n          \u003c/div>\n        \u003c/div>\n      \u003c/div>\n\n      \u003c!-- Logs de actividad -->\n      \u003cdiv>\n        \u003ch4 class=\"text-sm font-medium text-gray-900 dark:text-white mb-3\">Actividad Reciente\u003c/h4>\n        \u003cdiv class=\"bg-gray-50 dark:bg-gray-700 rounded-lg p-4 max-h-60 overflow-y-auto\">\n          \u003cdiv class=\"space-y-2\">\n            \u003cdiv v-for=\"log in activityLogs\" :key=\"log.id\" class=\"text-xs\">\n              \u003cspan class=\"text-gray-500 dark:text-gray-400\">{{ formatTime(log.timestamp) }}\u003c/span>\n              \u003cspan class=\"ml-2 text-gray-900 dark:text-white\">{{ log.message }}\u003c/span>\n            \u003c/div>\n          \u003c/div>\n        \u003c/div>\n      \u003c/div>\n    \u003c/div>\n  \u003c/div>\n\u003c/template>\n\n\u003cscript setup lang=\"ts\">\nimport { ref, computed, onMounted, onUnmounted } from 'vue'\nimport { useExtensionStore } from '@/components/extension-selector/ExtensionStore'\nimport { useSipStore } from '@/components/login/SipStore'\n// Importar iconos de Lucide Vue\nimport { \n  RotateCcw, \n  BellOff, \n  Voicemail, \n  ArrowRightLeft, \n} from 'lucide-vue-next'\n\nconst extensionStore = useExtensionStore()\nconst phoneStore = useSipStore()\n\n// Estado local del teléfono\nconst displayNumber = ref('')\nconst isCallActive = ref(false)\nconst currentCallNumber = ref('')\nconst callStartTime = ref\u003cDate | null>(null)\nconst callDuration = ref('00:00')\nconst callTimer = ref\u003cnumber | null>(null)\n\n// Variables para el botón de borrado unificado\nconst isDeleting = ref(false)\nconst deleteTimer = ref\u003cnumber | null>(null)\nconst deleteStartTime = ref\u003cnumber | null>(null)\nconst HOLD_DURATION = 500\n\n// Estado de los controles\nconst isDnd = ref(false)\nconst isMuted = ref(false)\nconst isAutoAnswerActive = ref(false)\nconst isAudioMicActive = ref(false)\nconst isOnHold = ref(false)\nconst lastDialedNumber = ref('')\n\nconst showAdvancedDialOptions = ref(false)\nconst audioInputDevices = ref\u003cMediaDeviceInfo[]>([])\nconst selectedMicId = ref\u003cstring | null>(null)\n\n// Logs de actividad\nconst activityLogs = ref([\n  { id: 1, timestamp: new Date(), message: 'SIP inicializado' },\n  { id: 2, timestamp: new Date(Date.now() - 60000), message: 'Conectando al servidor' },\n  { id: 3, timestamp: new Date(Date.now() - 120000), message: 'Aplicación iniciada' },\n])\n\nconst dialSounds: Record\u003c'0' | '1' | '2' | '3' | '4' | '5' | '6' | '7' | '8' | '9' | '*' | '#', HTMLAudioElement> = {\n  '0': new Audio(new URL('@/assets/wav/0.wav', import.meta.url).href),\n  '1': new Audio(new URL('@/assets/wav/1.wav', import.meta.url).href),\n  '2': new Audio(new URL('@/assets/wav/2.wav', import.meta.url).href),\n  '3': new Audio(new URL('@/assets/wav/3.wav', import.meta.url).href),\n  '4': new Audio(new URL('@/assets/wav/4.wav', import.meta.url).href),\n  '5': new Audio(new URL('@/assets/wav/5.wav', import.meta.url).href),\n  '6': new Audio(new URL('@/assets/wav/6.wav', import.meta.url).href),\n  '7': new Audio(new URL('@/assets/wav/7.wav', import.meta.url).href),\n  '8': new Audio(new URL('@/assets/wav/8.wav', import.meta.url).href),\n  '9': new Audio(new URL('@/assets/wav/9.wav', import.meta.url).href),\n  '*': new Audio(new URL('@/assets/wav/star.wav', import.meta.url).href),\n  '#': new Audio(new URL('@/assets/wav/hash.wav', import.meta.url).href),\n}\n\n// Configuración del teclado\nconst dialpadKeys = [\n  { value: '1', letters: '' },\n  { value: '2', letters: 'ABC' },\n  { value: '3', letters: 'DEF' },\n  { value: '4', letters: 'GHI' },\n  { value: '5', letters: 'JKL' },\n  { value: '6', letters: 'MNO' },\n  { value: '7', letters: 'PQRS' },\n  { value: '8', letters: 'TUV' },\n  { value: '9', letters: 'WXYZ' },\n  { value: '*', letters: '' },\n  { value: '0', letters: '+' },\n  { value: '#', letters: '' },\n]\n\n// Historial de llamadas\nconst recentCalls = ref([\n  { id: 1, number: '1234567890', type: 'outgoing', timestamp: new Date(Date.now() - 300000) },\n  { id: 2, number: '0987654321', type: 'incoming', timestamp: new Date(Date.now() - 600000) },\n  { id: 3, number: '1122334455', type: 'outgoing', timestamp: new Date(Date.now() - 900000) },\n])\n\n// Computed properties\nconst connectionStatus = computed(() => {\n  return phoneStore.isConnected ? 'Conectado' : 'Desconectado'\n})\n\nconst connectionStatusClass = computed(() => {\n  return phoneStore.isConnected ? 'bg-green-500' : 'bg-red-500'\n})\n\nconst connectionStatusTextClass = computed(() => {\n  return phoneStore.isConnected ? 'text-green-700 dark:text-green-400' : 'text-red-700 dark:text-red-400'\n})\n\nconst canCall = computed(() => {\n  return displayNumber.value.length > 0 && !isCallActive.value && phoneStore.isConnected\n})\n\nconst callButtonClass = computed(() => {\n  if (!canCall.value) {\n    return 'bg-gray-400 cursor-not-allowed'\n  }\n  return isCallActive.value\n    ? 'bg-red-500 hover:bg-red-600 focus:ring-red-500 animate-pulse'\n    : 'bg-green-500 hover:bg-green-600 focus:ring-green-500'\n})\n \nconst handleKeyDown = (event: KeyboardEvent) => {\n  if (isCallActive.value) return\n  \n  const key = event.key\n  \n  if (/^[0-9]$/.test(key)) {\n    event.preventDefault()\n    addDigit(key)\n    return\n  }\n  \n  if (key === '*') {\n    event.preventDefault()\n    addDigit('*')\n    return\n  }\n  \n  if (key === '#') {\n    event.preventDefault()\n    addDigit('#')\n    return\n  }\n  \n  if (key === 'Enter' && canCall.value) {\n    event.preventDefault()\n    handleCall()\n    return\n  }\n  \n  if (key === 'Escape' && isCallActive.value) {\n    event.preventDefault()\n    handleCall()\n    return\n  }\n  \n  if (key === 'Backspace' && displayNumber.value.length > 0) {\n    event.preventDefault()\n    clearLastDigit()\n    return\n  }\n  \n  if (key === 'Delete' && displayNumber.value.length > 0) {\n    event.preventDefault()\n    clearDisplay()\n    return\n  }\n}\n\n\n// Métodos del teléfono\nconst addDigit = (digit: string) => {\n  const sound = dialSounds[digit as keyof typeof dialSounds]\n  if (sound) {\n    sound.currentTime = 0\n    sound.play()\n  }\n  if (displayNumber.value.length \u003c 40) {\n    displayNumber.value += digit\n  }\n}\n\nconst startDelete = (event: MouseEvent | TouchEvent) => {\n  event.preventDefault()\n  if (displayNumber.value.length === 0 || isCallActive.value) return\n  \n  isDeleting.value = true\n  deleteStartTime.value = Date.now()\n  \n  deleteTimer.value = window.setTimeout(() => {\n    clearDisplay()\n    isDeleting.value = false\n  }, HOLD_DURATION)\n}\n\nconst endDelete = (event: MouseEvent | TouchEvent) => {\n  event.preventDefault()\n  if (!isDeleting.value) return\n  \n  isDeleting.value = false\n  \n  if (deleteTimer.value) {\n    clearTimeout(deleteTimer.value)\n    deleteTimer.value = null\n    \n    if (deleteStartTime.value && (Date.now() - deleteStartTime.value) \u003c HOLD_DURATION) {\n      clearLastDigit()\n    }\n  }\n  \n  deleteStartTime.value = null\n}\n\nconst clearLastDigit = () => {\n  displayNumber.value = displayNumber.value.slice(0, -1)\n}\n\nconst clearDisplay = () => {\n  displayNumber.value = ''\n}\n\nconst handleCall = async () => {\n  if (!canCall.value) return\n\n  if (isCallActive.value) {\n    await endCall()\n  } else {\n    await makeCall(displayNumber.value)\n  }\n}\n\nconst makeCall = async (number: string) => {\n  try {\n    lastDialedNumber.value = number\n    const success = await phoneStore.makeCall(number)\n    if (success) {\n      isCallActive.value = true\n      currentCallNumber.value = number\n      callStartTime.value = new Date()\n      startCallTimer()\n\n      recentCalls.value.unshift({\n        id: Date.now(),\n        number: number,\n        type: 'outgoing',\n        timestamp: new Date()\n      })\n\n      addActivityLog(`Llamada iniciada a ${number}`)\n    }\n  } catch (error) {\n    console.error('Error making call:', error)\n    addActivityLog(`Error al llamar a ${number}`)\n  }\n}\n\nconst endCall = async () => {\n  try {\n    await phoneStore.endCall()\n    isCallActive.value = false\n    addActivityLog(`Llamada terminada con ${currentCallNumber.value}`)\n    currentCallNumber.value = ''\n    callStartTime.value = null\n    stopCallTimer()\n  } catch (error) {\n    console.error('Error ending call:', error)\n  }\n}\n\nconst startCallTimer = () => {\n  callTimer.value = setInterval(() => {\n    if (callStartTime.value) {\n      const elapsed = Math.floor((Date.now() - callStartTime.value.getTime()) / 1000)\n      const minutes = Math.floor(elapsed / 60)\n      const seconds = elapsed % 60\n      callDuration.value = `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`\n    }\n  }, 1000)\n}\n\nconst stopCallTimer = () => {\n  if (callTimer.value) {\n    clearInterval(callTimer.value)\n    callTimer.value = null\n  }\n  callDuration.value = '00:00'\n}\n\nconst selectRecentCall = (number: string) => {\n  if (!isCallActive.value) {\n    displayNumber.value = number\n  }\n}\n\nconst formatTime = (date: Date) => {\n  return date.toLocaleTimeString('es-ES', {\n    hour: '2-digit',\n    minute: '2-digit'\n  })\n}\n\n// Métodos de control\nconst redial = () => {\n  if (lastDialedNumber.value && !isCallActive.value) {\n    displayNumber.value = lastDialedNumber.value\n    handleCall()\n  }\n}\n\nconst toggleDnd = () => {\n  isDnd.value = !isDnd.value\n  addActivityLog(`DND ${isDnd.value ? 'activado' : 'desactivado'}`)\n}\n\nconst checkVoicemail = () => {\n  addActivityLog('Verificando mensajes de voz')\n}\n\nconst toggleMute = () => {\n  isMuted.value = !isMuted.value\n  addActivityLog(`Micrófono ${isMuted.value ? 'silenciado' : 'activado'}`)\n}\n\nconst toggleAutoAnswer = () => {\n  isAutoAnswerActive.value = !isAutoAnswerActive.value\n  addActivityLog(`AutoAnswer ${isAutoAnswerActive.value ? 'activado' : 'desactivado'}`)\n}\n\nconst toggleAudioMic = () => {\n  isAudioMicActive.value = !isAudioMicActive.value\n  addActivityLog(`Audio/Mic ${isAudioMicActive.value ? 'activado' : 'desactivado'}`)\n}\n\nconst transferCall = () => {\n  if (isCallActive.value) {\n    addActivityLog('Iniciando transferencia de llamada')\n    // Implementar lógica de transferencia\n  }\n}\n\nconst toggleHold = () => {\n  if (isCallActive.value) {\n    isOnHold.value = !isOnHold.value\n    addActivityLog(`Llamada ${isOnHold.value ? 'en espera' : 'reanudada'}`)\n    // Implementar lógica de hold/unhold\n  }\n}\n\nconst addActivityLog = (message: string) => {\n  activityLogs.value.unshift({\n    id: Date.now(),\n    timestamp: new Date(),\n    message\n  })\n  \n  // Mantener solo los últimos 50 logs\n  if (activityLogs.value.length > 50) {\n    activityLogs.value = activityLogs.value.slice(0, 50)\n  }\n}\n\nconst toggleDialOptions = async () => {\n  showAdvancedDialOptions.value = !showAdvancedDialOptions.value\n\n  if (showAdvancedDialOptions.value) {\n    await loadAudioInputDevices()\n  }\n}\n\nconst loadAudioInputDevices = async () => {\n  try {\n    await navigator.mediaDevices.getUserMedia({ audio: true })\n\n    const devices = await navigator.mediaDevices.enumerateDevices()\n    audioInputDevices.value = devices.filter(device => device.kind === 'audioinput')\n  } catch (err) {\n    console.error('Error accediendo a dispositivos de audio:', err)\n  }\n}\n\nonMounted(() => {\n  window.addEventListener('keydown', handleKeyDown)\n})\n\nonUnmounted(() => {\n  stopCallTimer()\n  if (deleteTimer.value) {\n    clearTimeout(deleteTimer.value)\n  }\n  window.removeEventListener('keydown', handleKeyDown)\n})\n\u003c/script>\n\n\u003cstyle scoped>\n.dial-button:active {\n  transform: scale(0.95);\n}\n\n.control-button:active {\n  transform: scale(0.98);\n}\n\n@keyframes pulse {\n  0%, 100% {\n    opacity: 1;\n  }\n  50% {\n    opacity: 0.5;\n  }\n}\n\n.animate-pulse {\n  animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;\n}\n\n/* Responsive design */\n@media (max-width: 1024px) {\n  .softphone-container {\n    flex-direction: column;\n  }\n  \n  .phone-dialer {\n    width: 100%;\n    max-width: 400px;\n    margin: 0 auto;\n  }\n  \n  .control-panel, .dynamic-panel {\n    min-width: auto;\n  }\n}\n\n@media (max-width: 768px) {\n  .softphone-container {\n    padding: 2px;\n    gap: 2px;\n  }\n  \n  .control-panel, .dynamic-panel {\n    padding: 4px;\n  }\n}\n\u003c/style>","loc":{"file":"C:/respos/AlmaPhone/src/views/PhoneView.vue","line":162,"column":62}}
              try {
                const { ErrorOverlay } = await import("/@vite/client")
                document.body.appendChild(new ErrorOverlay(error))
              } catch {
                const h = (tag, text) => {
                  const el = document.createElement(tag)
                  el.textContent = text
                  return el
                }
                document.body.appendChild(h('h1', 'Internal Server Error'))
                document.body.appendChild(h('h2', error.message))
                document.body.appendChild(h('pre', error.stack))
                document.body.appendChild(h('p', '(Error overlay failed to load)'))
              }
            </script>
          </head>
          <body>
          </body>
        </html>
      
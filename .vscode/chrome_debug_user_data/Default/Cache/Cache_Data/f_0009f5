import { defineStore } from "/node_modules/.vite/deps/pinia.js?v=1d2656dc";
import { URI } from "/node_modules/.vite/deps/sip__js_lib_grammar_uri.js?v=1d2656dc";
import {
  SimpleUser
} from "/node_modules/.vite/deps/sip__js_lib_platform_web.js?v=1d2656dc";
import { ref } from "/node_modules/.vite/deps/vue.js?v=1d2656dc";
export const useSipStore = defineStore("sip", () => {
  const simpleUser = ref(null);
  const isConnected = ref(false);
  const isRegistered = ref(false);
  const voicemail = ref({ new: 0, old: 0 });
  const isDnd = ref(false);
  const isAutoAnswer = ref(false);
  const callState = ref("idle");
  const connectionState = ref(
    "disconnected"
  );
  const callStartTime = ref(null);
  const error = ref(null);
  const isMuted = ref(false);
  const isOnHold = ref(false);
  const audioElement = ref(null);
  const sipConfig = ref({
    server: "wss://hornblower.doesntexist.org:7443",
    username: "LDLQ2",
    password: "",
    domain: "hornblower.doesnotexist.com",
    displayName: ""
  });
  const createSimpleUserDelegate = () => ({
    onCallCreated: () => {
      console.log("Call created");
      callState.value = "calling";
      callStartTime.value = /* @__PURE__ */ new Date();
    },
    onCallReceived: async () => {
      console.log("Call received");
      if (isDnd.value) {
        console.log("Llamada entrante ignorada por DND");
        simpleUser.value?.hangup();
        return;
      }
      callState.value = "ringing";
      if (isAutoAnswer.value) {
        console.log("Auto-answer enabled, answering call");
        try {
          await simpleUser.value?.answer();
        } catch (err) {
          console.error("Error auto-answering call:", err);
          error.value = err instanceof Error ? err.message : "Error auto-answering call";
        }
      }
    },
    onCallAnswered: () => {
      console.log("Call answered");
      callState.value = "connected";
    },
    onCallHangup: () => {
      console.log("Call hangup");
      callState.value = "ended";
      callStartTime.value = null;
      isMuted.value = false;
      isOnHold.value = false;
    },
    onCallHold: (held) => {
      console.log(`Call hold ${held}`);
      isOnHold.value = held;
    },
    onRegistered: () => {
      console.log("Registered");
      isRegistered.value = true;
    },
    onUnregistered: () => {
      console.log("Unregistered");
      isRegistered.value = false;
    },
    onServerConnect: () => {
      console.log("Server connected");
      isConnected.value = true;
      connectionState.value = "connected";
    },
    onServerDisconnect: () => {
      console.log("Server disconnected");
      isConnected.value = false;
      isRegistered.value = false;
      connectionState.value = "disconnected";
      setTimeout(() => {
        if (simpleUser.value && connectionState.value === "disconnected") {
          reconnect();
        }
      }, 5e3);
    }
  });
  const initializeSip = async (config, remoteAudio) => {
    try {
      const finalConfig = {
        server: config.server || sipConfig.value.server,
        username: config.username,
        password: config.password,
        domain: config.domain || sipConfig.value.domain,
        displayName: config.displayName
      };
      sipConfig.value = { ...sipConfig.value, ...finalConfig };
      if (remoteAudio) {
        audioElement.value = remoteAudio;
      }
      connectionState.value = "connecting";
      error.value = null;
      const webSocketServer = sipConfig.value.server;
      const simpleUserOptions = {
        delegate: createSimpleUserDelegate(),
        media: {
          remote: {
            audio: audioElement.value || void 0
          }
        },
        userAgentOptions: {
          displayName: sipConfig.value.displayName,
          authorizationUsername: sipConfig.value.username,
          authorizationPassword: sipConfig.value.password,
          uri: new URI("sip", sipConfig.value.username, sipConfig.value.domain),
          transportOptions: {
            server: webSocketServer,
            connectionTimeout: 1e4,
            keepAliveInterval: 3e4,
            traceSip: true,
            allowLegacyNotifications: true,
            wsServerMaxReconnection: 5e3,
            wsServerReconnectionTimeout: 1,
            connectionRecoveryMaxInterval: 3,
            connectionRecoveryMinInterval: 2
          }
        }
      };
      simpleUser.value = new SimpleUser(webSocketServer, simpleUserOptions);
      await simpleUser.value.connect();
      await simpleUser.value.register();
      saveSipConfigToStorage();
      return true;
    } catch (err) {
      console.error("Error inicializando SIP:", err);
      error.value = err instanceof Error ? err.message : "Error desconocido";
      connectionState.value = "disconnected";
      return false;
    }
  };
  const reconnect = async () => {
    if (simpleUser.value) {
      connectionState.value = "reconnecting";
      try {
        await simpleUser.value.connect();
        await simpleUser.value.register();
      } catch (err) {
        console.error("Error reconnecting:", err);
        connectionState.value = "disconnected";
      }
    }
  };
  const makeCall = async (number) => {
    try {
      if (!simpleUser.value || !isConnected.value) {
        throw new Error("SIP no estÃ¡ conectado");
      }
      const target = `sip:${number}@${sipConfig.value.domain}`;
      await simpleUser.value.call(target, {
        inviteWithoutSdp: false
      });
      return true;
    } catch (err) {
      console.error("Error haciendo llamada:", err);
      error.value = err instanceof Error ? err.message : "Error en la llamada";
      callState.value = "idle";
      return false;
    }
  };
  const endCall = async () => {
    try {
      if (simpleUser.value) {
        await simpleUser.value.hangup();
      }
    } catch (err) {
      console.error("Error terminando llamada:", err);
      error.value = err instanceof Error ? err.message : "Error terminando llamada";
    }
  };
  const answerCall = async () => {
    try {
      if (simpleUser.value) {
        await simpleUser.value.answer();
      }
    } catch (err) {
      console.error("Error contestando llamada:", err);
      error.value = err instanceof Error ? err.message : "Error contestando llamada";
    }
  };
  const muteCall = () => {
    try {
      if (simpleUser.value) {
        simpleUser.value.mute();
        isMuted.value = simpleUser.value.isMuted();
      }
    } catch (err) {
      console.error("Error muting call:", err);
    }
  };
  const unmuteCall = () => {
    try {
      if (simpleUser.value) {
        simpleUser.value.unmute();
        isMuted.value = simpleUser.value.isMuted();
      }
    } catch (err) {
      console.error("Error unmuting call:", err);
    }
  };
  const toggleMute = () => {
    if (isMuted.value) {
      unmuteCall();
    } else {
      muteCall();
    }
  };
  const holdCall = async () => {
    try {
      if (simpleUser.value) {
        await simpleUser.value.hold();
      }
    } catch (err) {
      console.error("Error holding call:", err);
      error.value = err instanceof Error ? err.message : "Error poniendo en espera";
    }
  };
  const unholdCall = async () => {
    try {
      if (simpleUser.value) {
        await simpleUser.value.unhold();
      }
    } catch (err) {
      console.error("Error unholding call:", err);
      error.value = err instanceof Error ? err.message : "Error quitando de espera";
    }
  };
  const toggleHold = async () => {
    if (isOnHold.value) {
      await unholdCall();
    } else {
      await holdCall();
    }
  };
  const sendDTMF = async (tone) => {
    try {
      if (simpleUser.value) {
        await simpleUser.value.sendDTMF(tone);
      }
    } catch (err) {
      console.error("Error sending DTMF:", err);
      error.value = err instanceof Error ? err.message : "Error enviando DTMF";
    }
  };
  const disconnect = async () => {
    try {
      if (simpleUser.value) {
        await simpleUser.value.disconnect();
      }
      connectionState.value = "disconnected";
      isConnected.value = false;
      isRegistered.value = false;
    } catch (err) {
      console.error("Error disconnecting:", err);
      error.value = err instanceof Error ? err.message : "Error desconectando";
    }
  };
  const setAudioElement = (element) => {
    audioElement.value = element;
  };
  const updateAdvancedConfig = (config) => {
    if (config.domain) {
      sipConfig.value.domain = config.domain;
    }
    if (config.server) {
      sipConfig.value.server = config.server;
    }
  };
  const reinitializeWithExtension = async (extension) => {
    try {
      if (simpleUser.value && isConnected.value) {
        await disconnect();
      }
      await new Promise((resolve) => setTimeout(resolve, 1e3));
      return await initializeSip(extension, audioElement.value || void 0);
    } catch (err) {
      console.error("Error reinitializando SIP:", err);
      error.value = err instanceof Error ? err.message : "Error reinitializando SIP";
      return false;
    }
  };
  const loadSipConfigFromStorage = () => {
    const saved = localStorage.getItem("sipConfig");
    if (saved) {
      const parsed = JSON.parse(saved);
      sipConfig.value = { ...sipConfig.value, ...parsed };
    }
  };
  const saveSipConfigToStorage = () => {
    localStorage.setItem("sipConfig", JSON.stringify(sipConfig.value));
  };
  return {
    // State
    simpleUser,
    isRegistered,
    isConnected,
    connectionState,
    error,
    sipConfig,
    isAutoAnswer,
    voicemail,
    isDnd,
    callState,
    callStartTime,
    isMuted,
    isOnHold,
    // Actions
    initializeSip,
    makeCall,
    endCall,
    answerCall,
    muteCall,
    unmuteCall,
    toggleMute,
    holdCall,
    unholdCall,
    toggleHold,
    sendDTMF,
    disconnect,
    updateAdvancedConfig,
    setAudioElement,
    reconnect,
    reinitializeWithExtension,
    loadSipConfigFromStorage,
    saveSipConfigToStorage
  };
});

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlNpcFN0b3JlLnRzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGRlZmluZVN0b3JlIH0gZnJvbSAncGluaWEnXG5pbXBvcnQgeyBVUkkgfSBmcm9tICdzaXAuanMvbGliL2dyYW1tYXIvdXJpJ1xuaW1wb3J0IHtcbiAgU2ltcGxlVXNlcixcbiAgdHlwZSBTaW1wbGVVc2VyRGVsZWdhdGUsXG4gIHR5cGUgU2ltcGxlVXNlck9wdGlvbnMsXG59IGZyb20gJ3NpcC5qcy9saWIvcGxhdGZvcm0vd2ViJ1xuaW1wb3J0IHsgcmVmIH0gZnJvbSAndnVlJ1xuXG5leHBvcnQgY29uc3QgdXNlU2lwU3RvcmUgPSBkZWZpbmVTdG9yZSgnc2lwJywgKCkgPT4ge1xuICBjb25zdCBzaW1wbGVVc2VyID0gcmVmPFNpbXBsZVVzZXIgfCBudWxsPihudWxsKVxuICBjb25zdCBpc0Nvbm5lY3RlZCA9IHJlZihmYWxzZSlcbiAgY29uc3QgaXNSZWdpc3RlcmVkID0gcmVmKGZhbHNlKVxuICBjb25zdCB2b2ljZW1haWwgPSByZWYoeyBuZXc6IDAsIG9sZDogMCB9KVxuICBjb25zdCBpc0RuZCA9IHJlZihmYWxzZSlcbiAgY29uc3QgaXNBdXRvQW5zd2VyID0gcmVmKGZhbHNlKVxuICBjb25zdCBjYWxsU3RhdGUgPSByZWY8J2lkbGUnIHwgJ2NhbGxpbmcnIHwgJ3JpbmdpbmcnIHwgJ2Nvbm5lY3RlZCcgfCAnZW5kZWQnPignaWRsZScpXG4gIGNvbnN0IGNvbm5lY3Rpb25TdGF0ZSA9IHJlZjwnZGlzY29ubmVjdGVkJyB8ICdjb25uZWN0aW5nJyB8ICdjb25uZWN0ZWQnIHwgJ3JlY29ubmVjdGluZyc+KFxuICAgICdkaXNjb25uZWN0ZWQnLFxuICApXG4gIGNvbnN0IGNhbGxTdGFydFRpbWUgPSByZWY8RGF0ZSB8IG51bGw+KG51bGwpXG4gIGNvbnN0IGVycm9yID0gcmVmPHN0cmluZyB8IG51bGw+KG51bGwpXG4gIGNvbnN0IGlzTXV0ZWQgPSByZWYoZmFsc2UpXG4gIGNvbnN0IGlzT25Ib2xkID0gcmVmKGZhbHNlKVxuXG4gIGNvbnN0IGF1ZGlvRWxlbWVudCA9IHJlZjxIVE1MQXVkaW9FbGVtZW50IHwgbnVsbD4obnVsbClcblxuICBjb25zdCBzaXBDb25maWcgPSByZWYoe1xuICAgIHNlcnZlcjogJ3dzczovL2hvcm5ibG93ZXIuZG9lc250ZXhpc3Qub3JnOjc0NDMnLFxuICAgIHVzZXJuYW1lOiAnTERMUTInLFxuICAgIHBhc3N3b3JkOiAnJyxcbiAgICBkb21haW46ICdob3JuYmxvd2VyLmRvZXNub3RleGlzdC5jb20nLFxuICAgIGRpc3BsYXlOYW1lOiAnJyxcbiAgfSlcblxuICBjb25zdCBjcmVhdGVTaW1wbGVVc2VyRGVsZWdhdGUgPSAoKTogU2ltcGxlVXNlckRlbGVnYXRlID0+ICh7XG4gICAgb25DYWxsQ3JlYXRlZDogKCk6IHZvaWQgPT4ge1xuICAgICAgY29uc29sZS5sb2coJ0NhbGwgY3JlYXRlZCcpXG4gICAgICBjYWxsU3RhdGUudmFsdWUgPSAnY2FsbGluZydcbiAgICAgIGNhbGxTdGFydFRpbWUudmFsdWUgPSBuZXcgRGF0ZSgpXG4gICAgfSxcbiAgICBvbkNhbGxSZWNlaXZlZDogYXN5bmMgKCk6IFByb21pc2U8dm9pZD4gPT4ge1xuICAgICAgY29uc29sZS5sb2coJ0NhbGwgcmVjZWl2ZWQnKVxuICAgICAgaWYgKGlzRG5kLnZhbHVlKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdMbGFtYWRhIGVudHJhbnRlIGlnbm9yYWRhIHBvciBETkQnKVxuICAgICAgICBzaW1wbGVVc2VyLnZhbHVlPy5oYW5ndXAoKVxuICAgICAgICByZXR1cm5cbiAgICAgIH1cbiAgICAgIGNhbGxTdGF0ZS52YWx1ZSA9ICdyaW5naW5nJ1xuXG4gICAgICBpZiAoaXNBdXRvQW5zd2VyLnZhbHVlKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdBdXRvLWFuc3dlciBlbmFibGVkLCBhbnN3ZXJpbmcgY2FsbCcpXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgYXdhaXQgc2ltcGxlVXNlci52YWx1ZT8uYW5zd2VyKClcbiAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgYXV0by1hbnN3ZXJpbmcgY2FsbDonLCBlcnIpXG4gICAgICAgICAgZXJyb3IudmFsdWUgPSBlcnIgaW5zdGFuY2VvZiBFcnJvciA/IGVyci5tZXNzYWdlIDogJ0Vycm9yIGF1dG8tYW5zd2VyaW5nIGNhbGwnXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9LFxuICAgIG9uQ2FsbEFuc3dlcmVkOiAoKTogdm9pZCA9PiB7XG4gICAgICBjb25zb2xlLmxvZygnQ2FsbCBhbnN3ZXJlZCcpXG4gICAgICBjYWxsU3RhdGUudmFsdWUgPSAnY29ubmVjdGVkJ1xuICAgIH0sXG4gICAgb25DYWxsSGFuZ3VwOiAoKTogdm9pZCA9PiB7XG4gICAgICBjb25zb2xlLmxvZygnQ2FsbCBoYW5ndXAnKVxuICAgICAgY2FsbFN0YXRlLnZhbHVlID0gJ2VuZGVkJ1xuICAgICAgY2FsbFN0YXJ0VGltZS52YWx1ZSA9IG51bGxcbiAgICAgIGlzTXV0ZWQudmFsdWUgPSBmYWxzZVxuICAgICAgaXNPbkhvbGQudmFsdWUgPSBmYWxzZVxuICAgIH0sXG4gICAgb25DYWxsSG9sZDogKGhlbGQ6IGJvb2xlYW4pOiB2b2lkID0+IHtcbiAgICAgIGNvbnNvbGUubG9nKGBDYWxsIGhvbGQgJHtoZWxkfWApXG4gICAgICBpc09uSG9sZC52YWx1ZSA9IGhlbGRcbiAgICB9LFxuICAgIG9uUmVnaXN0ZXJlZDogKCk6IHZvaWQgPT4ge1xuICAgICAgY29uc29sZS5sb2coJ1JlZ2lzdGVyZWQnKVxuICAgICAgaXNSZWdpc3RlcmVkLnZhbHVlID0gdHJ1ZVxuICAgIH0sXG4gICAgb25VbnJlZ2lzdGVyZWQ6ICgpOiB2b2lkID0+IHtcbiAgICAgIGNvbnNvbGUubG9nKCdVbnJlZ2lzdGVyZWQnKVxuICAgICAgaXNSZWdpc3RlcmVkLnZhbHVlID0gZmFsc2VcbiAgICB9LFxuICAgIG9uU2VydmVyQ29ubmVjdDogKCk6IHZvaWQgPT4ge1xuICAgICAgY29uc29sZS5sb2coJ1NlcnZlciBjb25uZWN0ZWQnKVxuICAgICAgaXNDb25uZWN0ZWQudmFsdWUgPSB0cnVlXG4gICAgICBjb25uZWN0aW9uU3RhdGUudmFsdWUgPSAnY29ubmVjdGVkJ1xuICAgIH0sXG4gICAgb25TZXJ2ZXJEaXNjb25uZWN0OiAoKTogdm9pZCA9PiB7XG4gICAgICBjb25zb2xlLmxvZygnU2VydmVyIGRpc2Nvbm5lY3RlZCcpXG4gICAgICBpc0Nvbm5lY3RlZC52YWx1ZSA9IGZhbHNlXG4gICAgICBpc1JlZ2lzdGVyZWQudmFsdWUgPSBmYWxzZVxuICAgICAgY29ubmVjdGlvblN0YXRlLnZhbHVlID0gJ2Rpc2Nvbm5lY3RlZCdcblxuICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgIGlmIChzaW1wbGVVc2VyLnZhbHVlICYmIGNvbm5lY3Rpb25TdGF0ZS52YWx1ZSA9PT0gJ2Rpc2Nvbm5lY3RlZCcpIHtcbiAgICAgICAgICByZWNvbm5lY3QoKVxuICAgICAgICB9XG4gICAgICB9LCA1MDAwKVxuICAgIH0sXG4gIH0pXG5cbiAgY29uc3QgaW5pdGlhbGl6ZVNpcCA9IGFzeW5jIChcbiAgICBjb25maWc6IHtcbiAgICAgIHNlcnZlcj86IHN0cmluZ1xuICAgICAgdXNlcm5hbWU6IHN0cmluZ1xuICAgICAgcGFzc3dvcmQ6IHN0cmluZ1xuICAgICAgZG9tYWluPzogc3RyaW5nXG4gICAgICBkaXNwbGF5TmFtZTogc3RyaW5nXG4gICAgfSxcbiAgICByZW1vdGVBdWRpbz86IEhUTUxBdWRpb0VsZW1lbnQsXG4gICk6IFByb21pc2U8Ym9vbGVhbj4gPT4ge1xuICAgIHRyeSB7XG4gICAgICBjb25zdCBmaW5hbENvbmZpZyA9IHtcbiAgICAgICAgc2VydmVyOiBjb25maWcuc2VydmVyIHx8IHNpcENvbmZpZy52YWx1ZS5zZXJ2ZXIsXG4gICAgICAgIHVzZXJuYW1lOiBjb25maWcudXNlcm5hbWUsXG4gICAgICAgIHBhc3N3b3JkOiBjb25maWcucGFzc3dvcmQsXG4gICAgICAgIGRvbWFpbjogY29uZmlnLmRvbWFpbiB8fCBzaXBDb25maWcudmFsdWUuZG9tYWluLFxuICAgICAgICBkaXNwbGF5TmFtZTogY29uZmlnLmRpc3BsYXlOYW1lLFxuICAgICAgfVxuXG4gICAgICBzaXBDb25maWcudmFsdWUgPSB7IC4uLnNpcENvbmZpZy52YWx1ZSwgLi4uZmluYWxDb25maWcgfVxuXG4gICAgICBpZiAocmVtb3RlQXVkaW8pIHtcbiAgICAgICAgYXVkaW9FbGVtZW50LnZhbHVlID0gcmVtb3RlQXVkaW9cbiAgICAgIH1cblxuICAgICAgY29ubmVjdGlvblN0YXRlLnZhbHVlID0gJ2Nvbm5lY3RpbmcnXG4gICAgICBlcnJvci52YWx1ZSA9IG51bGxcblxuICAgICAgY29uc3Qgd2ViU29ja2V0U2VydmVyID0gc2lwQ29uZmlnLnZhbHVlLnNlcnZlclxuXG4gICAgICBjb25zdCBzaW1wbGVVc2VyT3B0aW9uczogU2ltcGxlVXNlck9wdGlvbnMgPSB7XG4gICAgICAgIGRlbGVnYXRlOiBjcmVhdGVTaW1wbGVVc2VyRGVsZWdhdGUoKSxcbiAgICAgICAgbWVkaWE6IHtcbiAgICAgICAgICByZW1vdGU6IHtcbiAgICAgICAgICAgIGF1ZGlvOiBhdWRpb0VsZW1lbnQudmFsdWUgfHwgdW5kZWZpbmVkLFxuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICAgIHVzZXJBZ2VudE9wdGlvbnM6IHtcbiAgICAgICAgICBkaXNwbGF5TmFtZTogc2lwQ29uZmlnLnZhbHVlLmRpc3BsYXlOYW1lLFxuICAgICAgICAgIGF1dGhvcml6YXRpb25Vc2VybmFtZTogc2lwQ29uZmlnLnZhbHVlLnVzZXJuYW1lLFxuICAgICAgICAgIGF1dGhvcml6YXRpb25QYXNzd29yZDogc2lwQ29uZmlnLnZhbHVlLnBhc3N3b3JkLFxuICAgICAgICAgIHVyaTogbmV3IFVSSSgnc2lwJywgc2lwQ29uZmlnLnZhbHVlLnVzZXJuYW1lLCBzaXBDb25maWcudmFsdWUuZG9tYWluKSxcbiAgICAgICAgICB0cmFuc3BvcnRPcHRpb25zOiB7XG4gICAgICAgICAgICBzZXJ2ZXI6IHdlYlNvY2tldFNlcnZlcixcbiAgICAgICAgICAgIGNvbm5lY3Rpb25UaW1lb3V0OiAxMDAwMCxcbiAgICAgICAgICAgIGtlZXBBbGl2ZUludGVydmFsOiAzMDAwMCxcbiAgICAgICAgICAgIHRyYWNlU2lwOiB0cnVlLFxuICAgICAgICAgICAgYWxsb3dMZWdhY3lOb3RpZmljYXRpb25zOiB0cnVlLFxuICAgICAgICAgICAgd3NTZXJ2ZXJNYXhSZWNvbm5lY3Rpb246IDUwMDAsXG4gICAgICAgICAgICB3c1NlcnZlclJlY29ubmVjdGlvblRpbWVvdXQ6IDEsXG4gICAgICAgICAgICBjb25uZWN0aW9uUmVjb3ZlcnlNYXhJbnRlcnZhbDogMyxcbiAgICAgICAgICAgIGNvbm5lY3Rpb25SZWNvdmVyeU1pbkludGVydmFsOiAyLFxuICAgICAgICAgIH0sXG4gICAgICAgIH0sXG4gICAgICB9XG5cbiAgICAgIHNpbXBsZVVzZXIudmFsdWUgPSBuZXcgU2ltcGxlVXNlcih3ZWJTb2NrZXRTZXJ2ZXIsIHNpbXBsZVVzZXJPcHRpb25zKVxuXG4gICAgICBhd2FpdCBzaW1wbGVVc2VyLnZhbHVlLmNvbm5lY3QoKVxuICAgICAgYXdhaXQgc2ltcGxlVXNlci52YWx1ZS5yZWdpc3RlcigpXG4gICAgICBzYXZlU2lwQ29uZmlnVG9TdG9yYWdlKClcblxuICAgICAgcmV0dXJuIHRydWVcbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGluaWNpYWxpemFuZG8gU0lQOicsIGVycilcbiAgICAgIGVycm9yLnZhbHVlID0gZXJyIGluc3RhbmNlb2YgRXJyb3IgPyBlcnIubWVzc2FnZSA6ICdFcnJvciBkZXNjb25vY2lkbydcbiAgICAgIGNvbm5lY3Rpb25TdGF0ZS52YWx1ZSA9ICdkaXNjb25uZWN0ZWQnXG4gICAgICByZXR1cm4gZmFsc2VcbiAgICB9XG4gIH1cblxuICBjb25zdCByZWNvbm5lY3QgPSBhc3luYyAoKTogUHJvbWlzZTx2b2lkPiA9PiB7XG4gICAgaWYgKHNpbXBsZVVzZXIudmFsdWUpIHtcbiAgICAgIGNvbm5lY3Rpb25TdGF0ZS52YWx1ZSA9ICdyZWNvbm5lY3RpbmcnXG4gICAgICB0cnkge1xuICAgICAgICBhd2FpdCBzaW1wbGVVc2VyLnZhbHVlLmNvbm5lY3QoKVxuICAgICAgICBhd2FpdCBzaW1wbGVVc2VyLnZhbHVlLnJlZ2lzdGVyKClcbiAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciByZWNvbm5lY3Rpbmc6JywgZXJyKVxuICAgICAgICBjb25uZWN0aW9uU3RhdGUudmFsdWUgPSAnZGlzY29ubmVjdGVkJ1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGNvbnN0IG1ha2VDYWxsID0gYXN5bmMgKG51bWJlcjogc3RyaW5nKTogUHJvbWlzZTxib29sZWFuPiA9PiB7XG4gICAgdHJ5IHtcbiAgICAgIGlmICghc2ltcGxlVXNlci52YWx1ZSB8fCAhaXNDb25uZWN0ZWQudmFsdWUpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdTSVAgbm8gZXN0w6EgY29uZWN0YWRvJylcbiAgICAgIH1cblxuICAgICAgY29uc3QgdGFyZ2V0ID0gYHNpcDoke251bWJlcn1AJHtzaXBDb25maWcudmFsdWUuZG9tYWlufWBcblxuICAgICAgYXdhaXQgc2ltcGxlVXNlci52YWx1ZS5jYWxsKHRhcmdldCwge1xuICAgICAgICBpbnZpdGVXaXRob3V0U2RwOiBmYWxzZSxcbiAgICAgIH0pXG5cbiAgICAgIHJldHVybiB0cnVlXG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBoYWNpZW5kbyBsbGFtYWRhOicsIGVycilcbiAgICAgIGVycm9yLnZhbHVlID0gZXJyIGluc3RhbmNlb2YgRXJyb3IgPyBlcnIubWVzc2FnZSA6ICdFcnJvciBlbiBsYSBsbGFtYWRhJ1xuICAgICAgY2FsbFN0YXRlLnZhbHVlID0gJ2lkbGUnXG4gICAgICByZXR1cm4gZmFsc2VcbiAgICB9XG4gIH1cblxuICBjb25zdCBlbmRDYWxsID0gYXN5bmMgKCk6IFByb21pc2U8dm9pZD4gPT4ge1xuICAgIHRyeSB7XG4gICAgICBpZiAoc2ltcGxlVXNlci52YWx1ZSkge1xuICAgICAgICBhd2FpdCBzaW1wbGVVc2VyLnZhbHVlLmhhbmd1cCgpXG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciB0ZXJtaW5hbmRvIGxsYW1hZGE6JywgZXJyKVxuICAgICAgZXJyb3IudmFsdWUgPSBlcnIgaW5zdGFuY2VvZiBFcnJvciA/IGVyci5tZXNzYWdlIDogJ0Vycm9yIHRlcm1pbmFuZG8gbGxhbWFkYSdcbiAgICB9XG4gIH1cblxuICBjb25zdCBhbnN3ZXJDYWxsID0gYXN5bmMgKCk6IFByb21pc2U8dm9pZD4gPT4ge1xuICAgIHRyeSB7XG4gICAgICBpZiAoc2ltcGxlVXNlci52YWx1ZSkge1xuICAgICAgICBhd2FpdCBzaW1wbGVVc2VyLnZhbHVlLmFuc3dlcigpXG4gICAgICB9XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBjb250ZXN0YW5kbyBsbGFtYWRhOicsIGVycilcbiAgICAgIGVycm9yLnZhbHVlID0gZXJyIGluc3RhbmNlb2YgRXJyb3IgPyBlcnIubWVzc2FnZSA6ICdFcnJvciBjb250ZXN0YW5kbyBsbGFtYWRhJ1xuICAgIH1cbiAgfVxuXG4gIGNvbnN0IG11dGVDYWxsID0gKCk6IHZvaWQgPT4ge1xuICAgIHRyeSB7XG4gICAgICBpZiAoc2ltcGxlVXNlci52YWx1ZSkge1xuICAgICAgICBzaW1wbGVVc2VyLnZhbHVlLm11dGUoKVxuICAgICAgICBpc011dGVkLnZhbHVlID0gc2ltcGxlVXNlci52YWx1ZS5pc011dGVkKClcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIG11dGluZyBjYWxsOicsIGVycilcbiAgICB9XG4gIH1cblxuICBjb25zdCB1bm11dGVDYWxsID0gKCk6IHZvaWQgPT4ge1xuICAgIHRyeSB7XG4gICAgICBpZiAoc2ltcGxlVXNlci52YWx1ZSkge1xuICAgICAgICBzaW1wbGVVc2VyLnZhbHVlLnVubXV0ZSgpXG4gICAgICAgIGlzTXV0ZWQudmFsdWUgPSBzaW1wbGVVc2VyLnZhbHVlLmlzTXV0ZWQoKVxuICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgdW5tdXRpbmcgY2FsbDonLCBlcnIpXG4gICAgfVxuICB9XG5cbiAgY29uc3QgdG9nZ2xlTXV0ZSA9ICgpOiB2b2lkID0+IHtcbiAgICBpZiAoaXNNdXRlZC52YWx1ZSkge1xuICAgICAgdW5tdXRlQ2FsbCgpXG4gICAgfSBlbHNlIHtcbiAgICAgIG11dGVDYWxsKClcbiAgICB9XG4gIH1cblxuICBjb25zdCBob2xkQ2FsbCA9IGFzeW5jICgpOiBQcm9taXNlPHZvaWQ+ID0+IHtcbiAgICB0cnkge1xuICAgICAgaWYgKHNpbXBsZVVzZXIudmFsdWUpIHtcbiAgICAgICAgYXdhaXQgc2ltcGxlVXNlci52YWx1ZS5ob2xkKClcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGhvbGRpbmcgY2FsbDonLCBlcnIpXG4gICAgICBlcnJvci52YWx1ZSA9IGVyciBpbnN0YW5jZW9mIEVycm9yID8gZXJyLm1lc3NhZ2UgOiAnRXJyb3IgcG9uaWVuZG8gZW4gZXNwZXJhJ1xuICAgIH1cbiAgfVxuXG4gIGNvbnN0IHVuaG9sZENhbGwgPSBhc3luYyAoKTogUHJvbWlzZTx2b2lkPiA9PiB7XG4gICAgdHJ5IHtcbiAgICAgIGlmIChzaW1wbGVVc2VyLnZhbHVlKSB7XG4gICAgICAgIGF3YWl0IHNpbXBsZVVzZXIudmFsdWUudW5ob2xkKClcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHVuaG9sZGluZyBjYWxsOicsIGVycilcbiAgICAgIGVycm9yLnZhbHVlID0gZXJyIGluc3RhbmNlb2YgRXJyb3IgPyBlcnIubWVzc2FnZSA6ICdFcnJvciBxdWl0YW5kbyBkZSBlc3BlcmEnXG4gICAgfVxuICB9XG5cbiAgY29uc3QgdG9nZ2xlSG9sZCA9IGFzeW5jICgpOiBQcm9taXNlPHZvaWQ+ID0+IHtcbiAgICBpZiAoaXNPbkhvbGQudmFsdWUpIHtcbiAgICAgIGF3YWl0IHVuaG9sZENhbGwoKVxuICAgIH0gZWxzZSB7XG4gICAgICBhd2FpdCBob2xkQ2FsbCgpXG4gICAgfVxuICB9XG5cbiAgY29uc3Qgc2VuZERUTUYgPSBhc3luYyAodG9uZTogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiA9PiB7XG4gICAgdHJ5IHtcbiAgICAgIGlmIChzaW1wbGVVc2VyLnZhbHVlKSB7XG4gICAgICAgIGF3YWl0IHNpbXBsZVVzZXIudmFsdWUuc2VuZERUTUYodG9uZSlcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHNlbmRpbmcgRFRNRjonLCBlcnIpXG4gICAgICBlcnJvci52YWx1ZSA9IGVyciBpbnN0YW5jZW9mIEVycm9yID8gZXJyLm1lc3NhZ2UgOiAnRXJyb3IgZW52aWFuZG8gRFRNRidcbiAgICB9XG4gIH1cblxuICBjb25zdCBkaXNjb25uZWN0ID0gYXN5bmMgKCk6IFByb21pc2U8dm9pZD4gPT4ge1xuICAgIHRyeSB7XG4gICAgICBpZiAoc2ltcGxlVXNlci52YWx1ZSkge1xuICAgICAgICBhd2FpdCBzaW1wbGVVc2VyLnZhbHVlLmRpc2Nvbm5lY3QoKVxuICAgICAgfVxuICAgICAgY29ubmVjdGlvblN0YXRlLnZhbHVlID0gJ2Rpc2Nvbm5lY3RlZCdcbiAgICAgIGlzQ29ubmVjdGVkLnZhbHVlID0gZmFsc2VcbiAgICAgIGlzUmVnaXN0ZXJlZC52YWx1ZSA9IGZhbHNlXG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBkaXNjb25uZWN0aW5nOicsIGVycilcbiAgICAgIGVycm9yLnZhbHVlID0gZXJyIGluc3RhbmNlb2YgRXJyb3IgPyBlcnIubWVzc2FnZSA6ICdFcnJvciBkZXNjb25lY3RhbmRvJ1xuICAgIH1cbiAgfVxuXG4gIGNvbnN0IHNldEF1ZGlvRWxlbWVudCA9IChlbGVtZW50OiBIVE1MQXVkaW9FbGVtZW50KTogdm9pZCA9PiB7XG4gICAgYXVkaW9FbGVtZW50LnZhbHVlID0gZWxlbWVudFxuICB9XG5cbiAgY29uc3QgdXBkYXRlQWR2YW5jZWRDb25maWcgPSAoY29uZmlnOiB7IGRvbWFpbj86IHN0cmluZzsgc2VydmVyPzogc3RyaW5nIH0pOiB2b2lkID0+IHtcbiAgICBpZiAoY29uZmlnLmRvbWFpbikge1xuICAgICAgc2lwQ29uZmlnLnZhbHVlLmRvbWFpbiA9IGNvbmZpZy5kb21haW5cbiAgICB9XG4gICAgaWYgKGNvbmZpZy5zZXJ2ZXIpIHtcbiAgICAgIHNpcENvbmZpZy52YWx1ZS5zZXJ2ZXIgPSBjb25maWcuc2VydmVyXG4gICAgfVxuICB9XG5cbiAgY29uc3QgcmVpbml0aWFsaXplV2l0aEV4dGVuc2lvbiA9IGFzeW5jIChleHRlbnNpb246IHtcbiAgICBzZXJ2ZXI/OiBzdHJpbmdcbiAgICB1c2VybmFtZTogc3RyaW5nXG4gICAgcGFzc3dvcmQ6IHN0cmluZ1xuICAgIGRpc3BsYXlOYW1lOiBzdHJpbmdcbiAgICBkb21haW4/OiBzdHJpbmdcbiAgfSk6IFByb21pc2U8Ym9vbGVhbj4gPT4ge1xuICAgIHRyeSB7XG4gICAgICBpZiAoc2ltcGxlVXNlci52YWx1ZSAmJiBpc0Nvbm5lY3RlZC52YWx1ZSkge1xuICAgICAgICBhd2FpdCBkaXNjb25uZWN0KClcbiAgICAgIH1cbiAgICAgIGF3YWl0IG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIDEwMDApKVxuXG4gICAgICByZXR1cm4gYXdhaXQgaW5pdGlhbGl6ZVNpcChleHRlbnNpb24sIGF1ZGlvRWxlbWVudC52YWx1ZSB8fCB1bmRlZmluZWQpXG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciByZWluaXRpYWxpemFuZG8gU0lQOicsIGVycilcbiAgICAgIGVycm9yLnZhbHVlID0gZXJyIGluc3RhbmNlb2YgRXJyb3IgPyBlcnIubWVzc2FnZSA6ICdFcnJvciByZWluaXRpYWxpemFuZG8gU0lQJ1xuICAgICAgcmV0dXJuIGZhbHNlXG4gICAgfVxuICB9XG5cbiAgY29uc3QgbG9hZFNpcENvbmZpZ0Zyb21TdG9yYWdlID0gKCk6IHZvaWQgPT4ge1xuICAgIGNvbnN0IHNhdmVkID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3NpcENvbmZpZycpXG4gICAgaWYgKHNhdmVkKSB7XG4gICAgICBjb25zdCBwYXJzZWQgPSBKU09OLnBhcnNlKHNhdmVkKVxuICAgICAgc2lwQ29uZmlnLnZhbHVlID0geyAuLi5zaXBDb25maWcudmFsdWUsIC4uLnBhcnNlZCB9XG4gICAgfVxuICB9XG5cbiAgY29uc3Qgc2F2ZVNpcENvbmZpZ1RvU3RvcmFnZSA9ICgpOiB2b2lkID0+IHtcbiAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnc2lwQ29uZmlnJywgSlNPTi5zdHJpbmdpZnkoc2lwQ29uZmlnLnZhbHVlKSlcbiAgfVxuXG4gIHJldHVybiB7XG4gICAgLy8gU3RhdGVcbiAgICBzaW1wbGVVc2VyLFxuICAgIGlzUmVnaXN0ZXJlZCxcbiAgICBpc0Nvbm5lY3RlZCxcbiAgICBjb25uZWN0aW9uU3RhdGUsXG4gICAgZXJyb3IsXG4gICAgc2lwQ29uZmlnLFxuICAgIGlzQXV0b0Fuc3dlcixcbiAgICB2b2ljZW1haWwsXG4gICAgaXNEbmQsXG4gICAgY2FsbFN0YXRlLFxuICAgIGNhbGxTdGFydFRpbWUsXG4gICAgaXNNdXRlZCxcbiAgICBpc09uSG9sZCxcblxuICAgIC8vIEFjdGlvbnNcbiAgICBpbml0aWFsaXplU2lwLFxuICAgIG1ha2VDYWxsLFxuICAgIGVuZENhbGwsXG4gICAgYW5zd2VyQ2FsbCxcbiAgICBtdXRlQ2FsbCxcbiAgICB1bm11dGVDYWxsLFxuICAgIHRvZ2dsZU11dGUsXG4gICAgaG9sZENhbGwsXG4gICAgdW5ob2xkQ2FsbCxcbiAgICB0b2dnbGVIb2xkLFxuICAgIHNlbmREVE1GLFxuICAgIGRpc2Nvbm5lY3QsXG4gICAgdXBkYXRlQWR2YW5jZWRDb25maWcsXG4gICAgc2V0QXVkaW9FbGVtZW50LFxuICAgIHJlY29ubmVjdCxcbiAgICByZWluaXRpYWxpemVXaXRoRXh0ZW5zaW9uLFxuICAgIGxvYWRTaXBDb25maWdGcm9tU3RvcmFnZSxcbiAgICBzYXZlU2lwQ29uZmlnVG9TdG9yYWdlLFxuICB9XG59KVxuIl0sIm1hcHBpbmdzIjoiQUFBQSxTQUFTLG1CQUFtQjtBQUM1QixTQUFTLFdBQVc7QUFDcEI7QUFBQSxFQUNFO0FBQUEsT0FHSztBQUNQLFNBQVMsV0FBVztBQUViLGFBQU0sY0FBYyxZQUFZLE9BQU8sTUFBTTtBQUNsRCxRQUFNLGFBQWEsSUFBdUIsSUFBSTtBQUM5QyxRQUFNLGNBQWMsSUFBSSxLQUFLO0FBQzdCLFFBQU0sZUFBZSxJQUFJLEtBQUs7QUFDOUIsUUFBTSxZQUFZLElBQUksRUFBRSxLQUFLLEdBQUcsS0FBSyxFQUFFLENBQUM7QUFDeEMsUUFBTSxRQUFRLElBQUksS0FBSztBQUN2QixRQUFNLGVBQWUsSUFBSSxLQUFLO0FBQzlCLFFBQU0sWUFBWSxJQUE0RCxNQUFNO0FBQ3BGLFFBQU0sa0JBQWtCO0FBQUEsSUFDdEI7QUFBQSxFQUNGO0FBQ0EsUUFBTSxnQkFBZ0IsSUFBaUIsSUFBSTtBQUMzQyxRQUFNLFFBQVEsSUFBbUIsSUFBSTtBQUNyQyxRQUFNLFVBQVUsSUFBSSxLQUFLO0FBQ3pCLFFBQU0sV0FBVyxJQUFJLEtBQUs7QUFFMUIsUUFBTSxlQUFlLElBQTZCLElBQUk7QUFFdEQsUUFBTSxZQUFZLElBQUk7QUFBQSxJQUNwQixRQUFRO0FBQUEsSUFDUixVQUFVO0FBQUEsSUFDVixV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